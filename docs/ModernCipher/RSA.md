## RSA密码算法

RSA密码算法是最经典的非对称密码算法，这种密码算法是基于大质数分解难题而设计的。

**值得注意的是，任何一种非对称密码算法都是基于这样一种数学难题——正向很容易求解，逆向特别难求解。比如RSA就是由两个大素数求其积比较容易，而已知两个大素数的积来分解两个大素数比较困难。**

## RSA密码算法流程

这里采用小的素数来进行计算并说明RSA密码算法的流程。

1. 选取两个素数，并计算它们的积；  

- 设两个素数分别为p=41、q=43
- 它们的积为n=p*q=1763

2. 设置公钥参数e并计算d;

- 令φ(n)=(q-1)(p-1)=1680  
- 选择公钥参数e=17，且gcd(e,φ(n))=1，其中gcd是求最大公约数的函数
- 求得d，使得d*e = 1 mod n，即d与e的乘积除以n的余数为1，一般来说，求d可以用扩展的欧几里得算法求解，见附录。这里求出d=593  

3. 加解密过程；
在步骤二中求得d之后，RSA的基本元素就凑齐了，第1步中求得n，与第2步中求得的de。其中(n,e)为公钥、(n,d)为私钥。  
首先来看加密过程，设加密的消息m=1207，一般来说，密文的长度不能超过n；  
加密：  
c = m^e mod n = 1207^17 mod 1763 = 1144  
解密：  
m = c^d mod n = 1144^593 mod 1763 = 1207  

## 附录

### 扩展的欧几里得算法

欧几里得算法（欧几里得算法又称辗转相除法）求公约数，这里以56与356的公约数：  
356 ÷ 56 = 6&emsp;&emsp;&emsp;365 % 56 = 20  
56 ÷ 20 = 2&emsp;&emsp;&emsp;56 % 20 = 16  
20 ÷ 16 = 1&emsp;&emsp;&emsp;20 % 16 = 4  
16 ÷ 4 = 4&emsp;&emsp;&emsp;16 % 4 = 0  
最大公约数为4。  
上述算法就为欧几里得算法，扩展的欧几里得算法是基于欧几里得算法的。以上面数字为例，将每一项逆推回去得到：  
4 = 20 - 16x1  
&emsp;= 20 - (56 - 20x2)x1  
&emsp;= 20x3 - 56  
&emsp;= (356 - 56x6)x3 - 56  
&emsp;= 356x3 - 56x19  
整理一下可以表示为：56x19 =-4 + 356x3，56x19 =-4 mod 356  
关于通过公钥参数求d也可以用类似的方法求解：  
ed = 1 mod φ(n)  
17d = 1 mod 1680

先用欧几里得算法把求最大公约数：  
1680 ÷ 17 = 98&emsp;&emsp;&emsp;1680 % 17 = 14  
17 ÷ 14 = 1&emsp;&emsp;&emsp;17 % 14 = 3  
14 ÷ 3 = 4&emsp;&emsp;&emsp;14 % 3 = 2  
3 ÷ 2 = 1&emsp;&emsp;&emsp;3 % 2 = 1  
2 ÷ 1 = 2&emsp;&emsp;&emsp;2 % 1 = 0  
扩展的欧几里得算法逆推如下：  
1 = 3 - 2 x 1  
&emsp;=3 x 5 - 14  
&emsp;=17 x 5 - 14 x 6  
&emsp;=17 x 5 - (1680 - 17 x 98) x 6  
&emsp;=17 x 593 - 1680 x 6  
两边同时除以1680得：17 x 593 = 1 mod 1680  
因此d = 593  